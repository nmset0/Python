# random forest feature importance

from sklearn.ensemble import RandomForestClassifier
import pandas as pd
import matplotlib.pyplot as plt

FRAME = pd.read_csv('Data/CombinedData_H2AWorkers_FEMA_AgrOutput_Healthcare.csv')
FRAME = FRAME.drop(FRAME.columns[0], axis=1)

# print(FRAME.columns.get_loc('Community_Clinics'))
# print(FRAME.columns.get_loc('CriticalAccessHospitals'))

Y = FRAME['MigrantHealthCenters']
X = FRAME.drop(columns=['MigrantHealthCenters'] + FRAME.columns[352:368].tolist()) # Drop response and healthcare facility columns
X = X._get_numeric_data()

forestModel = RandomForestClassifier(random_state = 335, criterion='gini')

forestModel.fit(X, Y)

importances = forestModel.feature_importances_
feature_importances = pd.Series(importances, index=X.columns)
feature_importances_sorted = feature_importances.sort_values(ascending=False)

plt.figure(figsize=(10, 6))
plt.bar(feature_importances_sorted.index, feature_importances_sorted.values)
plt.xticks(rotation=90, fontsize = 4.5)
plt.xlabel('Features')
plt.ylabel('Importance')
plt.title('Random Forest Feature Importances')
plt.show()





